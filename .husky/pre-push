#!/bin/sh

# WORKTREE GUARD - Block push to main from wrong location
bash .husky/worktree-guard.sh

# Original pre-push checks
echo "üöÄ Pre-push validation..."

# Get current branch
CURRENT_BRANCH=$(git branch --show-current)

# Block force push to main/master
if [[ "$CURRENT_BRANCH" == "main" ]] || [[ "$CURRENT_BRANCH" == "master" ]]; then
  # Check if this is a force push
  if [[ "$*" == *"--force"* ]] || [[ "$*" == *"-f"* ]]; then
    echo "‚ùå PUSH BLOCKED: Force push to main/master is forbidden"
    exit 1
  fi
fi

echo "‚úÖ Pre-push validation OK"
exit 0
