{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Protected Files Configuration",
  "description": "Définit les fichiers et dossiers protégés nécessitant une autorisation spéciale pour modification",
  "version": "1.0.0",
  "lastUpdated": "2025-10-21",
  "protected": {
    "description": "Fichiers/dossiers INTERDITS de modification directe sans autorisation owner",
    "patterns": [
      "docs/auth/**",
      "docs/metrics/**",
      "docs/database/triggers.md",
      "docs/database/best-practices.md",
      "docs/workflows/owner-daily-workflow.md",
      "docs/workflows/admin-daily-workflow.md",
      "supabase/migrations/*.sql",
      ".env.local",
      ".env.production",
      "CLAUDE.md",
      "PROTECTED_FILES.json"
    ],
    "notes": [
      "Modification = Backup obligatoire + PR avec justification détaillée",
      "Revue owner/tech-lead mandatory",
      "Tests complets avant merge"
    ]
  },
  "requiresReview": {
    "description": "Fichiers nécessitant revue obligatoire (1+ reviewer) avant merge",
    "patterns": [
      "src/lib/supabase/**",
      "src/hooks/use-*.ts",
      "src/app/api/**",
      "packages/kpi/**",
      ".github/workflows/**",
      "src/components/ui-v2/**",
      "src/lib/design-system/**"
    ],
    "notes": [
      "PR review obligatoire",
      "Tests unitaires requis",
      "Console error check mandatory"
    ]
  },
  "criticalFiles": {
    "description": "Fichiers critiques nécessitant backup AVANT toute modification",
    "files": [
      "supabase/migrations/*.sql",
      ".env.local",
      ".env.production",
      "package.json",
      "next.config.js",
      "tailwind.config.ts"
    ],
    "backup_procedure": "Voir docs/ci-cd/rollback-procedures.md"
  },
  "autoGenerated": {
    "description": "Fichiers générés automatiquement - NE PAS éditer manuellement",
    "patterns": [
      "src/types/supabase.ts",
      "node_modules/**",
      ".next/**",
      "out/**",
      "coverage/**",
      ".storybook-static/**"
    ],
    "notes": [
      "supabase.ts → Généré via 'supabase gen types typescript'",
      "node_modules → npm install",
      ".next → npm run build"
    ]
  },
  "exemptions": {
    "description": "Utilisateurs exemptés des restrictions (par pattern)",
    "users": {
      "owner": ["*"],
      "tech-lead": ["docs/**", "src/**", ".github/**"]
    }
  },
  "enforcement": {
    "description": "Comment ces règles sont appliquées",
    "methods": [
      "GitHub CODEOWNERS (.github/CODEOWNERS)",
      "GitHub Branch Protection Rules",
      "Pre-commit hooks (husky)",
      "CI/CD checks (GitHub Actions)"
    ]
  }
}
