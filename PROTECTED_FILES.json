{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Protected Files Configuration",
  "description": "Définit les fichiers et dossiers protégés nécessitant une autorisation spéciale pour modification",
  "version": "2.0.0",
  "lastUpdated": "2025-12-10",
  "protected": {
    "description": "Fichiers/dossiers INTERDITS de modification directe sans autorisation owner",
    "patterns": [
      "docs/auth/**",
      "docs/metrics/**",
      "docs/database/triggers.md",
      "docs/database/best-practices.md",
      "docs/database/SCHEMA-REFERENCE.md",
      "docs/database/README.md",
      "docs/workflows/owner-daily-workflow.md",
      "docs/workflows/admin-daily-workflow.md",
      "docs/modules/dashboard/**",
      "apps/back-office/src/app/dashboard/**",
      "apps/back-office/src/app/contacts-organisations/**",
      "apps/back-office/src/app/profile/**",
      "apps/back-office/src/app/admin/**",
      "apps/back-office/src/hooks/use-complete-dashboard-metrics.ts",
      "apps/back-office/src/hooks/use-organisations.ts",
      "apps/back-office/src/hooks/use-contacts.ts",
      "apps/back-office/src/hooks/use-customers.ts",
      "apps/back-office/src/hooks/use-toggle-favorite.ts",
      "apps/back-office/src/components/business/organisation-*.tsx",
      "apps/back-office/src/components/business/customer-*.tsx",
      "apps/back-office/src/components/business/contact-*.tsx",
      "supabase/migrations/*.sql",
      ".env.local",
      ".env.production",
      "CLAUDE.md",
      "PROTECTED_FILES.json"
    ],
    "notes": [
      "Modification = Backup obligatoire + PR avec justification détaillée",
      "Revue owner/tech-lead mandatory",
      "Tests complets avant merge"
    ]
  },
  "requiresReview": {
    "description": "Fichiers nécessitant revue obligatoire (1+ reviewer) avant merge",
    "patterns": [
      "apps/back-office/src/lib/supabase/**",
      "apps/back-office/src/hooks/use-*.ts",
      "apps/back-office/src/app/api/**",
      "packages/@verone/kpi/**",
      ".github/workflows/**",
      "packages/@verone/ui/src/**",
      "apps/back-office/src/lib/design-system/**"
    ],
    "notes": [
      "PR review obligatoire",
      "Tests unitaires requis",
      "Console error check mandatory"
    ]
  },
  "criticalFiles": {
    "description": "Fichiers critiques nécessitant backup AVANT toute modification",
    "files": [
      "supabase/migrations/*.sql",
      ".env.local",
      ".env.production",
      "package.json",
      "next.config.js",
      "tailwind.config.ts"
    ],
    "backup_procedure": "Voir docs/ci-cd/rollback-procedures.md"
  },
  "autoGenerated": {
    "description": "Fichiers générés automatiquement - NE PAS éditer manuellement",
    "patterns": [
      "apps/back-office/src/types/supabase.ts",
      "packages/@verone/types/src/supabase.ts",
      "node_modules/**",
      ".next/**",
      "out/**",
      "coverage/**"
    ],
    "notes": [
      "supabase.ts → Généré via 'supabase gen types typescript'",
      "node_modules → npm install",
      ".next → npm run build"
    ]
  },
  "exemptions": {
    "description": "Utilisateurs exemptés des restrictions (par pattern)",
    "users": {
      "owner": ["*"],
      "tech-lead": ["docs/**", "src/**", ".github/**"]
    }
  },
  "enforcement": {
    "description": "Comment ces règles sont appliquées",
    "methods": [
      "GitHub CODEOWNERS (.github/CODEOWNERS)",
      "GitHub Branch Protection Rules",
      "CI/CD checks (GitHub Actions)"
    ]
  },
  "phase1Validated": {
    "description": "Code Phase 1 VERROUILLÉ - Modification requiert autorisation owner",
    "validationDate": "2025-10-23",
    "modules": ["dashboard", "organisations", "contacts", "profile", "admin"],
    "features": [
      "CRUD organisations (Fournisseurs, Clients B2B/B2C, Partenaires)",
      "CRUD contacts multi-organisations",
      "Toggle favoris",
      "Vue grille/liste 4×3 responsive",
      "Pagination 1-5",
      "Dashboard 4 KPIs",
      "Profile user settings"
    ],
    "tests": {
      "e2e": "✅ Validés",
      "consoleErrors": "✅ 0 errors",
      "build": "✅ Succès",
      "performance": "✅ Dashboard <2s"
    },
    "documentation": {
      "path": "docs/modules/dashboard/",
      "coverage": "100%",
      "status": "✅ Production Ready"
    }
  }
}
